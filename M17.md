# Introducció a l'IoT (Internet of Things)

## Què és IoT?

IoT (Internet of Things) és un concepte que fa referència a la interconnexió digital d'objectes quotidians amb internet.

- **Definició de Gartner**:
  - IoT és la xarxa d'objectes físics ("coses") que contenen tecnologia incrustada per comunicar-se i interactuar amb els seus estats interns o amb l'entorn extern.

- **Origen del terme**:
  - El terme "Internet of Things" va ser acunyat per Kevin Ashton durant els anys 90, mentre treballava al MIT, en el Centre Auto-ID.

## Orígens i Desenvolupament

- **Centre Auto-ID del MIT**:
  - Aquest centre, on Kevin Ashton va ser cofundador, va ser clau en el desenvolupament de la tecnologia RFID (identificació per radiofreqüència) i en la creació de sensors.
  - Es va distribuir per 7 universitats situades en 4 continents i va jugar un paper fonamental en la definició de l'arquitectura de la IoT.

## Perspectiva de CISCO sobre IoT

- **Connexions a Internet**:
  - CISCO va preveure que des de l'any 2008 hi hauria més "coses" connectades a internet que persones.
  - Van crear un comptador de connexions dinàmic per estimar el nombre d'objectes connectats a internet des del juliol de 2013 fins al 2020.
  - Prediccions de CISCO (Abril de 2011):
    - Es calculava que hi hauria 25.000 milions de dispositius connectats a Internet l'any 2015 i 50.000 milions l'any 2020.

## La IoT en la Pràctica

- **Una xarxa de xarxes**:
  - La IoT es pot concebre com una gran xarxa que integra múltiples xarxes més petites.
  - Exemples:
    - Sensors en un vehicle.
    - Sistemes domòtics en cases o edificis.

## Impacte i Projeccions

- La IoT té el potencial de transformar la manera en què vivim i treballem, connectant la nostra realitat física a l'àmbit digital de maneres que encara estem explorant.

# Introducció a les Dades de l'IoT

L'IoT no només canvia la forma en què interactuem amb els objectes del nostre entorn, sinó que també genera una enorme quantitat de dades que poden ser utilitzades per a optimitzar processos, millorar la vida quotidiana, i impulsar la innovació.

## Estadístiques Clau

La següent taula mostra el creixement de les unitats IoT instal·lades per categoria en milions d'unitats:

| Categoria                    | 2016    | 2017    | 2018    | 2020    |
| ---------------------------- | ------- | ------- | ------- | ------- |
| Consumidor                   | 3,963.0 | 5,244.3 | 7,036.3 | 12,863.0|
| Negocis: Transversal         | 1,102.1 | 1,501.0 | 2,132.6 | 4,381.4 |
| Negocis: Específic del sector| 1,316.6 | 1,635.4 | 2,027.7 | 3,171.0 |
| Total General                | 6,381.8 | 8,380.6 | 11,196.6| 20,415.4|

(Font de les dades: Captura de pantalla de taula proporcionada)

## Prediccions del Mercat de l'IoT

El mercat de l'IoT és vast i divers, amb aplicacions que van des de la sanitat fins a la gestió intel·ligent de la energia:

![Market space prediction of IoT applications](link-to-image)

Alguns dels segments amb més potencial segons les prediccions són:

- Sanitat Intel·ligent: $1 Trillion
- Ciutats Intel·ligents: $1.6 Trillion
- Educació Intel·ligent: $344 Billion
- Energia: $400 Billion
- Habitatge i Vigilància Ambiental: $705 Billion

Les dades i prediccions mostren que la major part de les comunicacions a internet aviat podrien ser generades per dispositius IoT, amb un estimat de 26 bilions d'unitats interconnectades pel 2020 segons Gartner.

## Característiques i Objectius de la IoT

- **Ubiquitat**: La principal característica dels dispositius IoT és la seva omnipresència, estant presents en gairebé tots els àmbits de la nostra vida.
- **Anàlisi de Dades**: Un dels principals objectius de la IoT és analitzar les enormes quantitats de dades generades per millorar la presa de decisions i optimitzar processos.

La IoT està present en tots els àmbits, incloent la llar, les ciutats, la indústria, l'automoció, els jocs, i molt més, marcant així un abans i un després en la manera en què vivim i treballem.

# Casos d’ús de l’IoT

L'Internet de les Coses (IoT) s'estén a una àmplia varietat d'indústries i usos, incloent la vida quotidiana, la infraestructura urbana i les operacions industrials.

## Automòbils
- Sensors per a la recopilació de dades en temps real per a millorar la seguretat i eficiència.

## Ciutats
- Semàfors, enllumenat públic, contenidors d’escombraries i transports públics per a una gestió més intel·ligent i eficient.

## Casa
- Càmeres, televisors, mòbils, sistemes d’assistència, neveres, rentadores i routers connectats per a una domòtica avançada.

## Indústria (IIoT)
- Controladors, robots i sistemes de monitorització per a la optimització de processos i l’automatització.

## Agricultura
- Sensors per a mesurar la humitat i l’ús d’aigua, així com per a l'anàlisi de dades i millora de la presa de decisions.

## Hospitals
- Seguiment del material utilitzat en operacions, gestió d’escàners i control de l’estoc de medicaments.

# Aplicacions de l’IoT

Les aplicacions de l'IoT es poden classificar en diverses categories:

## Consum
- Dispositius amb CPU, memòria i capacitat energètica limitades per a recopilar informació.
- Neveres intel·ligents que mantenen l'estoc de productes.

## Empresarial (EIoT)
- Recopilació de dades dels consumidors per a estudis de mercat i segmentació de comportament.
- Publicitat dirigida i personalitzada basada en hàbits dels usuaris.

## Infraestructura
- Seguiment i control d’operacions d’infraestructura crítica com ponts i vies de ferrocarril.
- Sistemes per a la seguretat i minimització de riscos en ubicacions crítiques.

# Aplicacions de Consum de l’IoT

L'IoT està transformant la vida quotidiana amb una varietat d'aparells:

- Automòbils connectats.
- Sistemes d’entreteniment.
- Domòtica i tecnologia vestible.
- Electrodomèstics connectats, com rentadores i forns.

# Aplicacions Empresarials de l’IoT (EIoT)

- Dispositius en entorns corporatius que recullen dades per a anàlisis de mercat i comportament de consumidors.

# Aplicacions d'Infraestructura de l’IoT

- Control de components crítics d'infraestructures, com ponts i ferrocarrils, per a garantir la seguretat i eficiència.

L'IoT ofereix un món de possibilitats i està en constant evolució, afectant gairebé tots els aspectes de la nostra vida moderna.


# Altres Tipus d’Aplicacions de l’IoT

L'Internet de les Coses continua expandint les seves aplicacions en diversos camps, des de l'agricultura fins a la medicina i més enllà.

## Agricultura
- Reducció de residus i millora de productivitat mitjançant l'ús eficient de fertilitzants i combustibles.
- Sensors de llum, temperatura, humitat, i del sòl per a la gestió automatitzada del reg.

## Medicina i Salut
- Seguiment remot de pacients i sistemes de notificació d’emergències.
- Dispositius com monitors de pressió sanguínia, marcapassos, i audiòfons intel·ligents.
- Llits hospitalaris intel·ligents que millorar la cura i seguretat dels pacients.
- Innovacions com el DEKA's Luke Arm per a la rehabilitació i millora de la qualitat de vida dels pacients.

## Transport
- Gestió avançada dels vehicles, infraestructura, i usuaris.
- Control intel·ligent de trànsit, estacionament, peatges, i logística de flota.
- Monitoreig de la ubicació i condicions de la càrrega a temps real amb alertes per incidents.

## Indústria (IIoT)
- Utilitzat en entorns industrials per a monitoritzar i automatitzar processos.
- Mesura de pol·lució ambiental i automatització de maquinària amb robots.

Les aplicacions de l'IoT en aquests camps milloren significativament l'eficiència, la seguretat, i la sostenibilitat en diferents sectors, mostrant el poder de la connectivitat i l'anàlisi de dades.


# Seguretat de l’IoT

## Problemes de Seguretat en IoT
- La seguretat és un dels problemes principals en l’àmbit de l'IoT.
- Falta de regulació clara i explícita per als fabricants, tot i que hi ha normatives específiques per a certs àmbits, com dispositius per a ITS (Sistemes de Transport Intel·ligents) o energia.

## Vulnerabilitats Comuns
- Molts dispositius vénen amb contrasenyes per defecte que són simples o ja conegudes, i no sempre és obligatori canviar-les, causant problemes de seguretat.
- El maneig d’actualitzacions és deficient; o no es contemplen o no es realitzen per falta de mecanismes fàcils i definits.

## Estadístiques de 2015
- Quasi la meitat de les aplicacions de dispositius mòbils no encriptaven les comunicacions.
- El 70% dels dispositius IoT presentaven vulnerabilitats en les seves contrasenyes.

## Exemples de Vulnerabilitats
- Càmeres de vigilància per a nadons podien ser hackejades per accedir al vídeo.
- Cafeteres amb contrasenya no encriptada podrien expossar les contrasenyes de la xarxa Wi-Fi.

## Protecció de Dades
- Els dispositius IoT recopilen dades sobre els hàbits dels usuaris, la qual cosa planteja preocupacions sobre la privadesa.
- Es podria utilitzar xifratge i encriptació de les dades al pujar-les al núvol per millorar la seguretat.

## Enfocament de Seguretat segons OWASP
- La seguretat en IoT difereix de la seguretat en dispositius tradicionals.
- L'enfocament de securització ha de ser holístic i cobrir múltiples àmbits:
  - **Securitzar el dispositiu**: Inclou S.O., firmware, interfícies de gestió.
  - **El Cloud**: On s'emmagatzemen les dades.
  - **La xarxa**: Com viatgen les dades, quins ports estan oberts, etc.
  - **Aplicacions mòbils**: Per accedir i utilitzar els dispositius.
  - **Xifrat**: Utilització de tecnologies de xifratge avançades.
  - **Mecanismes d’autenticació**: Assegurar-se que només els usuaris autoritzats puguin accedir.
  - **Seguretat física**: Protegir els dispositius de manipulació física.
  - **Ports i interfícies físiques**: Assegurar els punts d’accés com USB, Bluetooth, xarxa, etc.


# Arquitectura dels dispositius IoT

## Nivells del Model d'IoT

| Nivell | Descripció |
| ------ | ----------- |
| 7      | **Col·laboració i processos** (Implicació de persones i processos empresarials) - Transcendeix múltiples aplicacions per incloure la comunicació i la col·laboració necessàries entre les persones i els processos empresarials. |
| 6      | **Aplicació** (Informes, anàlisi, control) - Interpretació de la informació basada en la naturalesa de les dades del dispositiu i les necessitats empresarials. |
| 5      | **Abstracció de dades** (Aggregació i accés) - Centrat en la representació de les dades i el seu emmagatzematge per permetre el desenvolupament d'aplicacions. |
| 4      | **Acumulació de dades** (emmagatzematge) - Les dades en moviment es converteixen en dades en repòs. Les dades també es transformen perquè puguin ser consumides pels nivells superiors. |
| 3      | **Edge (fog) Computing** (Anàlisi i transformació d’elements de dades) - Converteix les dades en informació adequada per a emmagatzematge i processament de nivell superior. |
| 2      | **Connectivitat** (Unitats de processament i comunicació) - Responsable de la transmissió de dades fiable i oportuna entre els dispositius i la xarxa, a través de xarxes i entre la xarxa i el processament de dades al nivell 3. |
| 1      | **Dispositius físics i controladors** (Les "coses" d'IoT) - Inclou una àmplia gamma de dispositius de punt final que envien i reben informació. |

## Seguretat en l'Arquitectura d'IoT

Les mesures de seguretat del model inclouen:
- Securitzar el hardware i software de cada dispositiu o sistema connectat a la xarxa IoT.
- Proveir seguretat a tots els processos que succeeixin a cada nivell en la xarxa.
- Securitzar el moviment de les dades i comunicacions entre cada nivell.

## Representació Gràfica del Model d'IoT

- El model consta de 7 nivells, des de l'Edge fins al Centre.
- **Nivell 1**: Dispositius físics i controladors
- **Nivell 2**: Connectivitat
- **Nivell 3**: Edge (Fog) Computing
- **Nivell 4**: Acumulació de dades
- **Nivell 5**: Abstracció de dades
- **Nivell 6**: Aplicació
- **Nivell 7**: Col·laboració i Processos
- La seguretat s'estén en tots els nivells, des de la perifèria ('Edge') fins al centre ('Center').


![Arquitectura IoT segons ETSI](link-a-la-imatge)

L'arquitectura dels dispositius IoT segons el model de l'European Telecommunications Standards Institute (ETSI) estructura les comunicacions M2M i integra els dispositius IoT en tres dominis principals:

- **Domini de l'Aplicació (Application Domain):**
  - Inclou les **aplicacions M2M** i les **aplicacions client**.
  - Funcions de gestió com l'anàlisi de dades, gestió de connectivitat, gestió intel·ligent de l'energia, gestió de flotes, etc.

- **Domini de Xarxa (Network Domain):**
  - Conté el **nucli M2M (M2M Core)**.
  - Les dades es transfereixen des de la xarxa local al domini de l'aplicació mitjançant protocols com **MPLS**, **LTE** i **WiMax**.

- **Domini de Dispositiu M2M (M2M Device Domain):**
  - Inclou els **dispositius finals** com sensors, actuadors i controladors.
  - Els dispositius es connecten a la xarxa a través de **passarel·les M2M** amb protocols com **IEEE 802.15.4** i **Bluetooth**.

![Estructura de l'IoT amb capes funcionals i protocols](URL-de-la-imatge)

### Estructura Simplificada de l'IoT
La imatge mostra una estructura simplificada de l'IoT dividida en tres capes funcionals principals:

- **Capa d'Aplicació:** Inclou diverses aplicacions que utilitzen protocols com HTTP, MQTT i CoAP.
- **Capa de Comunicació:** Empra protocols com Zigbee, Thread, RPL, IPv6 i 6LoWPAN per la transmissió de dades.
- **Capa de Dispositiu:** Conté els protocols de connectivitat de dispositius físics, com IEEE 802.15.4, Bluetooth LE, Wi-Fi, NFC i altres tecnologies de xarxa.

Aquesta imatge també destaca les diferents capes del model TCP/IP des de Transport fins a Network Access, ressaltant com els diversos protocols IoT s'encapsulen dins aquest estàndard de comunicació.

### Context
El text proporcionat discuteix altres models d'arquitectura IoT utilitzats per organitzar i entendre millor els sistemes IoT complexos. Exemples inclouen:

- **Model Purdue:** Utilitzat en la indústria manufacturera per segmentar dispositius i equips en funcions jeràrquiques.
- **IIRA (Industrial Internet Reference Architecture):** Un marc del Consorci d'Internet Industrial (IIC) per a arquitectes de sistemes.
- **IoT-A (Internet de les Coses - Arquitectura):** També conegut com a ARM (Model de referència arquitectònica) per a Internet de les coses, mantingut pel fòrum IoT-A.

### Gestió de Dades i Seguretat en IoT
La gestió de dades es pot realitzar a la capa Mist (a prop de dispositius) o a la capa Fog (en dispositius locals més potents). La seguretat ha de ser una consideració omnipresent, com s'indica amb una fletxa en el gràfic, suggerint que la seguretat ha de travessar totes les capes i aspectes del sistema IoT.

## Capa de Dispositiu en l'IoT

La **Capa de Dispositiu** en una arquitectura IoT inclou diversos estàndards i protocols per permetre la connectivitat i la comunicació. Aquests inclouen:

- **IEEE 802.15.4:** 
  - Aquest estàndard de l'Institut d'Enginyers Elèctrics i Electrònics és per a xarxes d'àrea personal sense fils de baix rate (LR-WPAN).
  - Utilitzat per dispositius de baix cost i baixa velocitat, és fonamental per a moltes aplicacions IoT que requereixen baix consum d'energia.

- **Bluetooth Low Energy (BLE):** 
  - És una versió de Bluetooth específica per a usos on cal un baix consum d'energia.
  - Funciona a la freqüència de ràdio de 2,4 GHz i és ideal per a dispositius que necessiten intercanviar petites quantitats de dades.

- **Wi-Fi:** 
  - Protocol estàndard per a xarxes d’àrea local sense fils (WLAN).
  - Funciona a les freqüències de 2,4 GHz i 5 GHz i és àmpliament utilitzat en dispositius que requereixen major ample de banda.

- **NFC (Comunicació de Camp Proper):** 
  - Permet la comunicació de dispositiu a dispositiu a curta distància (menys de 4 cm).
  - Usat per a transaccions sense contacte i intercanvi d'informació ràpid.

- **Tecnologies Mòbils (Cellular):** 
  - Inclou tecnologies de tercera generació (3G), quarta generació (4G), LTE i cinquena generació (5G) cobertes pel Projecte de col·laboració de tercera generació (3GPP).
  - Aquestes tecnologies són crucials per a la connectivitat IoT en moviment i a escala global.

- **LPWAN (LoRaWAN, Sigfox, NB-IoT):** 
  - Xarxes d’àrea ampla de baixa potència dissenyades per a comunicacions IoT.
  - Transporten petites càrregues útils de dades a llargues distàncies a taxes de transferència baixes, optimitzant així la vida de la bateria.

## Capa de Comunicació en l'IoT

La **Capa de Comunicació** està dissenyada per facilitar l'intercanvi de dades entre dispositius IoT i altres sistemes a través de diverses tecnologies i protocols:

- **Thread (fil):**
  - Un estàndard per a la domòtica que permet la comunicació sobre xarxes sense fils IEEE 802.15.4 utilitzant el protocol IPv6.

- **TCP (Protocol de Control de Transport):**
  - Protocol de transport fiable que assegura l'entrega de dades mitjançant la sincronització i confirmació de missatges.

- **UDP (User Datagram Protocol):**
  - Protocol de transport no fiable i lleuger sense un sistema garantit d'enviament de dades.

- **RPL (Routing Protocol for Low-Power and Lossy Networks):**
  - Protocol d'encaminament dissenyat per a xarxes amb dispositius que sovint experimenten altes taxes de pèrdua i inestabilitat.
  - Utilitza IPv6 per a la seva implementació.

- **IPv6 (Internet Protocol versió 6):**
  - Protocol amb un espai d'adreces de 128 bits, proporcionant 3,4x10^38 adreces úniques, suficients per a l'escala de dispositius IoT.

- **6LoWPAN (IPv6 over Low power Wireless Personal Area Networks):**
  - Un estàndard IETF que permet a IPv6 ser adaptat per a xarxes IEEE 802.15.4, optimitzant la comunicació entre les capes de xarxa de comunicacions i dispositius.

## Capa d'Aplicació en l'IoT

La **Capa d'Aplicació** inclou el conjunt de protocols i estàndards destinats a facilitar la comunicació entre les aplicacions IoT:

- **Zigbee:**
  - Una suite de protocols d'alta nivell que fa ús de ràdios digitals de baixa potència basades en l'estàndard IEEE 802.15.4, majoritàriament situats en la capa d'aplicació.

- **HTTP/HTTPS (Protocol de Transferència d'Hipertext):**
  - Protocols d'aplicació robustos utilitzats per a la sol·licitud i publicació de dades a través d'Internet.

- **MQTT (Message Queueing Telemetry Transport):**
  - Un protocol de missatgeria lleuger basat en el patró de publicació/subscripció, optimitzat per a dispositius amb recursos limitats que operen sobre TCP/IP.

- **CoAP (Constrained Application Protocol):**
  - Un protocol d'aplicació especialitzat dissenyat per a la transmissió eficient de dades en entorns de comunicació M2M (màquina a màquina) en xarxes de dispositius amb restriccions de capacitat.

## Model d'Estructura de Sistema IoT de Quatre Capes

El segon model de sistemes IoT es presenta amb una estructura de quatre nivells:

- **Dispositiu:**
  - La base de la piràmide, representant el hardware físic: sensors, actuadors, i altres dispositius finals que recopilen dades o realitzen accions.

- **Connectivitat i comunicació:**
  - Aquesta capa gestiona la comunicació entre els dispositius IoT i altres parts del sistema, incloent protocols, xarxes sense fil, i passarel·les.

- **Plataforma i anàlisi de dades:**
  - En aquest nivell es processen les dades recopilades, sovint mitjançant plataformes al núvol que ofereixen eines d'anàlisi i emmagatzematge de dades.

- **Aplicació:**
  - La capa superior, on les dades processades s'utilitzen per alimentar aplicacions específiques que permeten als usuaris interactuar amb els dispositius o obtenir informació valuosa a partir de les dades recollides.

- **Seguretat:**
  - Encara que no es mostra com un nivell individual, la seguretat s'estén a través de totes les capes, essent un aspecte crític que cal tenir en compte en cada etapa del desenvolupament i desplegament d'un sistema IoT.

## Capa de Dispositiu en Sistemes IoT

### Descripció General
La **capa de dispositiu** constitueix la base física d'un sistema IoT, i inclou els components hardware que recullen dades o executen tasques. Aquesta capa pot connectar-se directament o indirectament a Internet.

### Tipus de Connexions
- **Connexions Directes:**
  - Dispositius com Arduino amb mòduls Ethernet o WiFi, que poden connectar-se directament a Internet.
- **Connexions Indirectes:**
  - Dispositius que s'enllacen mitjançant tecnologies de ràdio de baixa potència (com Bluetooth o Zigbee) a dispositius intermediaris com Raspberry Pi o Arduino, els quals gestionen la connexió a Internet.

### Identificació Única
- Cada dispositiu IoT ha de tenir un **identificador únic (UUID)** per a la seva identificació dins de la xarxa. Aquest pot ser:
  - L'identificador de Bluetooth.
  - L'adreça MAC en xarxes WiFi.
  - Un token d'autenticació com OAuth2.

### Sensors i Actuadors
- Els **sensors** són els elements que recullen informació de l'entorn, mentre que els **actuadors** són els que realitzen accions com a resposta a les dades processades.
- Aquests dispositius utilitzen protocols específics per connectar-se i comunicar-se amb la xarxa.

La seguretat i la gestió eficaç de la identitat són claus en aquesta capa per assegurar que els dispositius són autèntics i que les dades es manejen de manera segura.


# MQTT:

## Tipus de Missatge i Descripció

- `CONNECT`: Petició del client per a connectar-se al servidor (vegeu Fig1)
- `CONNACK`: Reconeixement de la connexió
- `PUBLISH`: Edició missatge
- `PUBACK`: Reconeixement de l'edició
- `PUBREC`: Edició rebuda (part 1)
- `PUBREL`: Edició al·liberada (part 2)
- `PUBCOMP`: Edició completa (part 3)
- `SUBSCRIBE`: Petició de subscripció de client
- `SUBACK`: Reconeixement de subscripció
- `UNSUBSCRIBE`: Petició de desubscripció de client
- `UNSUBACK`: Reconeixement de desubscripció
- `PINGREQ`: Petició de PING
- `PINGRESP`: Resposta de PING
- `DISCONNECT`: Client desconnectant

## Fig. 1 Missatge tipus CONNECT

(Imatge de l'estructura del missatge CONNECT)

## Comparativa MQTT vs HTTP

| Acció                           | Protocol HTTP | Protocol MQTT | Relació HTTP/MQTT |
|---------------------------------|---------------|---------------|-------------------|
| Rebrem una unitat de dades (la mínima) | 320 bytes     | 69 bytes      | 4,6               |
| Enviar una unitat de dades (la mínima) | 320 bytes     | 47 bytes      | 6,8               |
| Rebrem 100 unitats de dades (la mínima) | 12600 bytes   | 2445 bytes    | 5,1               |
| Enviar 100 unitats de dades (la mínima) | 14100 bytes   | 2126 bytes    | 6,6               |

## Connectivitat/Comunicacions

### Aquesta capa permet:

- Comunicació entre els diferents elements d’un sistema IoT.
- Intercanvi de dades i informació, així com la comunicació amb Internet.
- Funció dels punts d’accés.

### Xarxes segons cobertura:

- LANs, WANs, PANs.

### Protocols de xarxa:

- ZigBee, CoAP, BLE, Ethernet, Bluetooth, WiFi, LoRaWAN, MQTT, AMQP, DDS, RFID, USB, etc.

### Infraestructura per comunicacions:

- Routers, gateway, firewalls, etc.

### Protocols per IoT:

- MQTT: Protocol de transport de telemetria de cua de missatges.
- CoAP.

### Característiques de MQTT:

- Basat en un model d'intermediari i en el protocol TCP/IP.
- Suporta xarxes amb connexió amb llocs remots amb pèrdues intermitents de dades.
- Funciona sobre TCP, utilitza el mínim de bytes per missatge.
- QoS (Quality of Service) per garantir fiabilitat.

### Funcionament de MQTT:

- Els clients es comuniquen amb un servidor anomenat broker.
- Un client pot ser un publisher o un subscriber.
- Els clients es connecten al broker.
- La informació s'organitza en una jerarquia de temes o tòpics.
- Un publisher envia un missatge de control al broker.
- El broker distribueix la informació als clients subscrits al tòpic.
- Configuració de missatge predeterminat per desconnexions inesperades.
- Interacció amb un sol broker, encara que un sistema pot tenir diversos brokers.

# MQTT i CoAP en Sistemes d'IoT

## MQTT (Message Queuing Telemetry Transport)
- **Client A**:
  - Connecta amb el **Broker** i s'hi subscriu per rebre dades de temperatura.
  - Publica valors de temperatura (per exemple, `25 °C` i `38 °C` a diferents moments).
  - Finalment es desconnecta del broker.

- **Broker**:
  - Actua com un intermediari, rebent publicacions de **Client A**.
  - Transmet la informació pertinent al **Client B** quan aquest es subscriu.

- **Client B**:
  - Subscriu-se al broker per rebre actualitzacions de temperatura.
  - Rep publicacions de **Client A** a través del broker.

### Tipus de Missatges en MQTT
- Connect
- Disconnect
- Publish

## CoAP (Constrained Application Protocol)
- Protocol client/servidor per a dispositius amb recursos limitats.
- Funciona sobre UDP i facilita un protocol de sol·licitud RESTful.
- Utilitza DTLS per seguretat.
- Suporta comunicació Multicast.

### Característiques del CoAP
- Disenyat per a entorns amb microcontroladors de baixa potència i xarxes amb alta taxa d'error.
- Ideal per a aplicacions M2M com l'automatització d'edificis i energia intel·ligent.

### Format del Missatge CoAP
- El missatge CoAP més petit és de 4 bytes (sense testimoni, opcions, o càrrega útil).
- Utilitza una capçalera simple i binària per a peticions i respostes.
- Pot incloure opcions en un format de longitud i valor optimitzat.
- Lligat a UDP i opcionalment a DTLS per seguretat.
- La longitud del cos del missatge és implícita a la llargada del datagrama.
---
# Resum d'Estudi: Arquitectura IoT, Plataforma i Anàlisi de Dades

## Plataforma IoT
- La capa de plataforma IoT és essencial per obtenir i processar la informació dels dispositius connectats.
- Necessita aplicacions capaces de gestionar grans volums de dades (Big Data) i plataformes al núvol per emmagatzemar i accedir a la informació.

## Tractament de Dades
- L'intercanvi i recollida de dades requereixen tractament per convertir-les en informació útil.
- Termes com "exaflood" o "data deluge" descriuen l'augment massiu de dades generades per objectes connectats.
- El tractament de dades implica l'ús de plataformes que gestionen comunicacions H2M (Humans a Màquines) i M2M (Màquines a Màquines), incloent API's.

## Serveis del Núvol en IoT
- Els serveis del núvol faciliten la integració i el processament de dades de dispositius distribuïts.
- Ofereixen serveis com emmagatzematge i escalabilitat.

## Anàlisi de Dades
- L'anàlisi de dades recopilades proporciona informació valiosa.
- Aquesta informació és útil per a la presa de decisions, visualització de resultats, automatització de processos, i per a la creació de quadres de comandaments.

# Resum d'Estudi: Arquitectura IoT i Aplicació

## Capa d'Aplicació en IoT
- Constitueix la capa superior, proporcionant serveis finals dirigits tant a persones com a màquines.
- Inclou aplicacions mòbils, aplicacions web, panells de control tàctils i específics.

## Punt Clau en Arquitectura IoT
- **Dispositiu**: El component físic que recull dades.
- **Comunicacions i Connectivitat**: Els mitjans pels quals els dispositius es connecten i comuniquen.
- **Emmagatzemament i Anàlisi de Dades**: Lloc on les dades són guardades i analitzades per extreure informació.
- **Seguretat**: Mesures i protocols per a protegir el sistema i les dades.
- **Escalabilitat i Alta Disponibilitat**: La capacitat del sistema per a créixer i operar continuament sense interrupcions.
- **Integració**: La combinació harmònica de tots els components i serveis del sistema.
- **Aplicacions**: El software que proporciona la funcionalitat directa als usuaris finals.

---
# Resum d'Estudi: Sistemes Operatius en IoT

## Necessitat de Sistemes Operatius en IoT
- Els dispositius poden funcionar sense sistema operatiu (SO), però amb l'increment de la complexitat, els SO són cada vegada més comuns.
- Dispositius amb menys de 16K de RAM i Flash/ROM generalment no requereixen un SO.
- Hi ha una gran varietat de SO disponibles per a dispositius IoT, i la seva elecció dependrà de múltiples factors relacionats amb el dispositiu i el seu ús.

## Característiques a Considerar per a la Selecció d'un SO en IoT
- **Empremta (Footprint)**: Requisits mínims de hardware i memòria per evitar sobrecàrregues.
- **Escalabilitat**: Capacitat de ser escalable per adaptar-se a qualsevol tipus de dispositiu.
- **Portabilitat**: Capacitat de funcionar independentment de les característiques específiques del hardware.
- **Modularitat**: Un kernel central amb funcions addicionals modulars.
- **Connectivitat**: Suport per a diversos protocols com Ethernet, Bluetooth, WiFi, LoRaWAN, entre d'altres.
- **Temps Real**: Funcionament en temps real per a dispositius crítics com els mèdics o de control de seguretat.
- **Seguretat**: Nivells de seguretat avançats incloent suport per SSL, autenticació segura, xifratge, etc.
- **Fiabilitat**: Indispensable per a dispositius en entorns crítics, amb el suport de normatives o estàndards específics.
- **Eficiència Energètica**: Importància de l'estalvi energètic per a la reducció de costos en el canvi de bateries o manteniment.

---
# Resum d'Estudi: Sistemes Operatius IoT

## Sistemes Operatius Més Usats en IoT
El gràfic visualitzat mostra els sistemes operatius per a dispositius IoT més utilitzats, destacant Linux com el líder clar, seguit per Windows i FreeRTOS entre d'altres.

## Tipus de Sistemes Operatius IoT

### Open Source
- **TinyOS**: Un dels més antics, optimitzat per a dispositius amb recursos limitats.
- **Contiki**: Conocido per ser extremadament lleuger i per a dispositius de baix consum.
- **RIOT**: Un dels més moderns RTOS dissenyats per a operacions en temps real.

### Comercials
- **Android Things**: Basat en Android, orientat a dispositius IoT connectats.
- **Windows 10 IoT**: La oferta de Microsoft per a dispositius IoT.
- **VxWorks de WindRiver**: Un RTOS per a dispositius crítics i sistemes embebidos.

## Consideracions per la Selecció d'un SO en IoT
- Es tria en base a criteris com ara la petjada de memòria, escalabilitat, portabilitat, modularitat, connectivitat, suport en temps real i seguretat.

---
# Resum d'Estudi: Vulnerabilitats i Amenaces en IoT

## Tríada CIA en Ciberseguretat
- **Confidencialitat**: Control d'accés i encriptació de la informació per protegir la privacitat.
- **Integritat**: Protecció de les dades contra modificació o destrucció no autoritzada.
- **Disponibilitat**: Assegurar l'accés a la informació quan es necessiti.

## 10 Requeriments de Seguretat IoT Crítics

### Referents al Sistema
1. **Privacitat de Dades**: Assegurar la confidencialitat de la informació.
2. **Minimitzar Atacs de Superfície**: Reduir punts vulnerables explotables per hackers.
3. **Registre d'Events Crítics**: Monitorització i alertes d'activitat inusual en la xarxa.
4. **Suport a Operacions de Seguretat**: Formació i gestió del personal de seguretat.

### Referents a la Capa Dispositiu
5. **Seguretat d'Arrencada i Integritat del Sistema**: Prevenir manipulacions del sistema operatiu o programari.
6. **Sistema Endurit i Segur**: Evitar l'execució de serveis de xarxa innecessaris.
7. **Actualitzacions de Firmware i SO**: Trobar mètodes per actualitzar dispositius en ubicacions remotes.

### Referents a la Capa Comunicació
8. **Comunicacions Segures**: Evitar intercepcions i assegurar l'autenticitat de les fonts de dades.

### Referents a la Capa d'Aplicació
9. **Credencials Predeterminades o Febles**: Fortificar l'autenticació i canviar credencials predeterminades.
10. **Interfícies Web Segures**: Protegir contra ciberatacs i assegurar la seguretat en l'ús d'APIs.

---
# Resum d'Estudi: Vulnerabilitats i Amenaces en IoT (Segons OWASP)

## 1. Inseguretat en les Aplicacions Webs de Gestió d'IOT
### Obstacles
- Noms d'usuari i passwords per defecte.
- Absència de bloqueig de comptes.
- Vulnerabilitats XSS, CSRF, SQLi.
### Solucions
- Permetre canvi de credencials per defecte.
- Habilitar el bloqueig del compte.
- Avaluació de seguretat de les aplicacions web.

## 2. Mecanismes Febles d'Autenticació i Autorització
### Obstacles
- Passwords febles.
- Mecanismes de recuperació de passwords insegurs.
- Falta d'autenticació de doble factor.
### Solucions
- Fomentar l'ús de passwords forts i complexos.
- Assegurar els processos de recuperació de passwords.
- Implementar doble factor d'autenticació.

## 3. Inseguretat en els Serveis de Xarxa
### Obstacles
- Ports innecessaris oberts.
- Exposició de ports a internet via UPnP.
- Serveis de xarxa susceptibles a atacs de denegació de servei.
### Solucions
- Reduir els ports oberts.
- Evitar l'ús de UPnP.
- Auditar serveis de xarxa per a vulnerabilitats.

## 4. Falta de Xifrat en les Comunicacions
### Obstacles
- Transmissió de dades sensibles sense xifrat.
- Manca d'ús de SSL/TLS.
- Ús de protocols d'encriptació propietaris.
### Solucions
- Encriptar tota la comunicació.
- Mantenir i actualitzar implementacions SSL/TLS.
- No recórrer a encriptació propietària.

## 5. Privacitat de les Dades
### Obstacles
- Recopilació excessiva de dades personals.
- Protecció inadequada de les dades recollides.
- Manca d'opció per a l'usuari en la recol·lecció de dades.
### Solucions
- Limitar la recol·lecció de dades.
- Anonimitzar les dades recollides.
- Oferir control a l'usuari sobre les dades recollides.

---
## 6. Inseguretat al Núvol
### Obstacles
- Interfícies no revisades per vulnerabilitats.
- Presència de passwords febles.
- Manca d'autenticació de doble factor.
### Solucions
- Avaluacions de seguretat periòdiques de les interfícies del núvol.
- Implementació de doble factor d'autenticació.
- Exigència de passwords forts i complexos.

## 7. Inseguretat en les Aplicacions Mòbils
### Obstacles
- Ús de passwords febles.
- Falta d'autenticació de doble factor.
- Absència de mecanismes de bloqueig de compte.
### Solucions
- Implementació de bloqueig de compte després d'intents fallits de connexió.
- Adopció de doble factor d'autenticació.
- Requeriment de passwords forts.

## 8. Inseguretat en els Dispositius IoT
### Obstacles
- Falta d'opcions de seguretat per a contrasenyes.
- Manca d'opcions d'encriptació.
- Absència d'opcions per a habilitar el registre de seguretat.
### Solucions
- Habilitació del registre de seguretat.
- Opcions per a xifratge habilitades.
- Notificació als usuaris sobre alertes de seguretat.

## 9. Inseguretat al Software dels Dispositius IoT
### Obstacles
- Servidors d'actualitzacions insegurs.
- Transmissió d'actualitzacions sense xifrar.
- Actualitzacions no signades digitalment.
### Solucions
- Signatura digital de les actualitzacions.
- Verificació de les actualitzacions abans de la instal·lació.
- Seguretat millorada en els servidors d'actualitzacions.

## 10. Inseguretat Física
### Obstacles
- Ports externs innecessaris com els ports USB.
- Accés a sistemes operatius via dispositius extraïbles.
- Incapacitat de restringir capacitats administratives.
### Solucions
- Reducció de ports externs com USB.
- Protecció reforçada del sistema operatiu.
- Possibilitat de limitar capacitats administratives.

---
